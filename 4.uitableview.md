 #UITableView
在iOS开发中UITableView可以说是一个最为核心且应用广泛的控件，包括QQ、微信、微博等无数应用都能见到它的身影。于此同时继承自UIScrollView的UITableView用法也相对复杂，出现的问题也较多，所以在这里将UITableView的一些常用方法和问题作一个分析总结。

####1.UITableViewDataSource-数据源
UITableView要显示数据，那它要知道显示多少数据，显示什么数据，以什么样的方式呈现。这一点UITableView的数据源DataSource为我们考虑到了，当一个对象想成为数据源就必须遵守UITableView的数据源协议UITableViewDataSource并实现相应的协议方法。
**@required**
- numberOfRowsInSection方法:
返回每一组的行数，有多少组就调用多少次

 ```objc
 - (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section;
```

- cellForRowAtIndexPath方法:  
返回cell，有多少个cell就调用多少次

 ```objc
 - (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {
    //如果用UITableViewController则可以在IB上设置重用标识   
    static NSString *ID = @"mainCell";
    //离开tableview可视范围的cell被丢入缓存池，当需要创建cell的时候根据Cell标识从缓存池中取cell,从而避免了不停创建新的cell消耗内存。
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:ID];
    if (!cell) {
        //如果用UITableViewController则可以在IB上设置cell模板
        cell = [[UITableViewCell alloc]initWithStyle:UITableViewCellStyleDefault reuseIdentifier:ID];
    }
    
    Hero *hero = self.data[indexPath.row];
    //cell的textLabel、imageView等子控件其实都在cell.contentView里
    cell.textLabel.text = hero.name;
    cell.imageView.image = [UIImage imageNamed:hero.icon];
    return cell;
}
```

**@optional**
- numberOfSectionsInTableView方法:
返回组数，调用reloadData刷新数据时有多少组就调用多少次，如果不实现则默认为一组

 ```objc
 - (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView; 
```
对于有多少组首先和tableview的style有关，tableview有两种style即Plain和Grouped如下图所示：Plain(普通类型)可以认为其组数为1，此时numberOfRowsInSection无效，当为Grouped(组类型)时有多少组就返回多少。

<div align="center">
<img src = "assets/pic4-1.png"</>
</div>

- titleForHeaderInSection方法

 返回每一组的头部标题，如下图所示
 ```objc
 - (nullable NSString *)tableView:(UITableView *)tableView titleForHeaderInSection:(NSInteger)section {
      return @"this head title";
 }
```
<div align="center">
<img src = "assets/pic4-2.png"</>
</div>


- titleForFooterInSection方法

 返回每一组的底部标题，如下图所示

  ```objc
  - (nullable NSString *)tableView:(UITableView *)tableView titleForFooterInSection:(NSInteger)section {
      return @"this footer title";
 }
```
<div align="center">
<img src = "assets/pic4-3.png"</>
</div>

  设置了头尾部标题的Plain样式的tableView在向上滑动时第一个头部标题不动直到第二个头部标题或尾部标题将它顶出tableview可视区域，如下图所示;
<div align="center">
<img src = "assets/pic4-4.gif"</>
</div>

如果tableview的样式为Grouped则没有Plain样式的滑动效果，如下图所示：

<div align="center">
<img src = "assets/pic4-5.gif"</>
</div>


####2.UITableViewDelegate-代理

- didSelectRowAtIndexPath方法:选中某个cell
```objc
 - (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath {
    NSLog(@"cell is selected");
}
```

- didDeselectRowAtIndexPath方法:取消选中某个cell
```objc
 - (void)tableView:(UITableView *)tableView didDeselectRowAtIndexPath:(NSIndexPath *)indexPath {
     NSLog(@"cell is deselected");
}
```

- heightForRowAtIndexPath方法:返回不同cell的高度
//该方法在创建cell时会调用，如果在内部创建cell则会造成死循环
```objc
 - (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath {
    if (indexPath.row == 0) {
        return 50;
    }
    return 60;
    //以下方法返回cell高度会造成死循环
    XHStatusCell * cell = [tableView cellForRowAtIndexPath:indexPath];
    return cell.height;
}
```

####3.UITableViewCell的一些设置

- cell取消选中的样式
```objc
    cell.selectionStyle = UITableViewCellSelectionStyleNone;
```

- cell选中的背景
```objc
  UIView *selectedBackgroundView = [[UIView alloc]init];
  selectedBackgroundView.backgroundColor = [UIColor redColor];
  cell.selectedBackgroundView = selectedBackgroundView;
```

- cell设置指示器
```objc
       cell.accessoryType = UITableViewCellAccessoryDisclosureIndicator;
       //cell.accessoryView = [[UISwitch alloc]init];
```



####4.UITableView的一些设置
- separator分割线颜色

```objc
self.tableView.separatorColor = [UIColor blueColor];

```





- separator分割线延伸设置
```objc
    self.tableView.separatorStyle = UITableViewCellSeparatorStyleNone;
```

- tableviewcell分割线延伸到边缘
ios7后cell分割线距离tableview左边缘有一定距离，可以通过以下方法将分割线延伸或者直接在IB上将Separator Inset左右距离都设置成0。

 ```objc
 - (void)viewDidLayoutSubviews {
    [super viewDidLayoutSubviews];
    if ([self.tableView respondsToSelector:@selector(setSeparatorInset:)]) {
         [self.tableView setSeparatorInset:UIEdgeInsetsZero];
    }
    if ([self.tableView respondsToSelector:@selector(setLayoutMargins:)]) {
        [self.tableView setLayoutMargins:UIEdgeInsetsZero];
    }
}
```
<div align="center">
<img src = "assets/pic4-6.png"</>
</div>


- tableview cell高度设置
```objc
 //所有cell等高
 self.tableView.rowHeight = 80;
```

- tableview cell高度设置








































####3.UITableView应用实例
**1）实例1**
要求：如下图，实现三组，其行数分别为2、5、1行的基本样式。
<div align="center">
<img src = "assets/pic4-1.png"</>
</div>

```objc
@interface ViewController ()<UITableViewDataSource>
@property (weak, nonatomic) IBOutlet UITableView *tableVIew;
@end

@implementation ViewController

- (void)viewDidLoad {
    [super viewDidLoad];
    self.tableVIew.dataSource = self;

}

#pragma mark - UITableViewDataSource

- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView {
    return 3;
}
- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section {
    if (section == 0) {
        return 2;
    } else if (section == 1) {
        return 5;
    }
    return 1;
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {
    UITableViewCell *cell = [[UITableViewCell alloc]init];
    cell.textLabel.text = @"mxh";
    return cell;
}

@end

```
